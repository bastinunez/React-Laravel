import{r as u,q as k,W as P,j as s}from"./app-peuYjEpJ.js";import{A as M,b as t,t as C,u as z}from"./AuthenticatedLayout-p56YD4qG.js";import{T as G}from"./TitleTemplate-VNYP4QaZ.js";import{C as E}from"./ContentTemplate-Ei9JbHLa.js";import{I as a}from"./InputLabel-wkdhkWUR.js";import{I as n}from"./InputError-9KAUk6AJ.js";import{T as o}from"./TextInput-kaLmirDK.js";import{T as q}from"./toast.esm-scV4M1sv.js";import{d as B,a as L,b as V,m as W}from"./chunk-L6QJ42W6-TZgBgFLH.js";import"./import-a4H3-vU0.js";import"./import-afMrECeO.js";const ls=({auth:r})=>{const x=u.useRef(null),p={success:"success",error:"error"},j={success:"Exito",error:"Error"},f=(e,l,R)=>{x.current.show({severity:l,summary:R,detail:e,life:3e3})},[i,d]=u.useState(!0),[m,h]=u.useState(!1),{hasRole:F,hasPermission:H}=z(),{flash:w}=k().props,{data:c,setData:v,post:D,processing:J,errors:g,reset:b}=P({nombres:r.user.nombres,apellidos:r.user.apellidos,correo:r.user.correo,rut:r.user.rut,rol:r.user.roles,permisos:r.user.permisos}),{data:N,setData:_,post:S,processing:T,errors:y,reset:K}=P({current_password:"",nueva_pwd:""}),A=e=>{e.preventDefault(),D(route("usuario.edit_data"),{onSuccess:()=>d(!i),onError:()=>b("nombres","apellidos")})},I=e=>{e.preventDefault(),S(route("usuario.update_pwd"),{onSuccess:l=>{f(l.update,p.success,j.success)},onError:l=>{f(l.update,p.error,j.error)}})};return s.jsxs(M,{user:r.user,header:s.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Mi Perfil"}),children:[s.jsx(G,{children:"Mi Perfil"}),s.jsx(q,{ref:x}),s.jsx(E,{children:s.jsx("div",{children:s.jsxs("form",{onSubmit:A,children:[s.jsxs("div",{className:"pt-5",children:[s.jsxs("div",{className:"w-full xl:flex justify-between mb-4",children:[s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Nombres"}),s.jsx(o,{className:"w-full",disabled:i,type:"text",value:c.nombres,onChange:e=>v("nombres",e.target.value)}),s.jsx(n,{message:g.nombres,className:"mt-2"})]}),s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Apellidos"}),s.jsx(o,{className:"w-full",disabled:i,type:"text",value:c.apellidos,onChange:e=>v("apellidos",e.target.value)}),s.jsx(n,{message:g.apellidos,className:"mt-2"})]}),s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Correo"}),s.jsx(o,{className:"w-full",disabled:!0,type:"text",value:c.correo})]})]}),s.jsxs("div",{className:"w-full justify-between xl:flex",children:[s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Rut"}),s.jsx(o,{className:"w-full",disabled:!0,type:"text",value:c.rut})]}),s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Rol"}),s.jsx(o,{className:"w-full",disabled:!0,type:"text",value:c.rol})]}),F("Administrador")?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Permisos"}),s.jsxs(B,{type:"listbox",children:[s.jsx(L,{children:s.jsx(t,{variant:"bordered",children:"Ver Permisos"})}),s.jsx(V,{className:"h-64 overflow-auto","aria-label":"Static Actions",children:c.permisos.map((e,l)=>s.jsx(W,{children:e},l))})]})]})}):s.jsx(s.Fragment,{})]})]}),s.jsx("div",{className:"pt-5 xl:flex w-full xl:mx-auto justify-center mt-3 text-large",children:i?s.jsx(s.Fragment,{children:s.jsx(t,{variant:"ghost",color:"primary",className:"w-full xl:mx-8",onClick:e=>d(!i),children:"Editar mis datos"})}):s.jsxs(s.Fragment,{children:[s.jsx(t,{variant:"ghost",color:"warning",className:"w-full xl:mx-8",onClick:e=>{b("nombres","apellidos"),d(!i)},children:"Cancelar"}),s.jsx(t,{variant:"ghost",color:"success",disabled:T,className:"w-full xl:mx-8",type:"submit",children:"Guardar cambios"})]})}),w.success_form_edit?s.jsx(s.Fragment,{children:s.jsx("div",{children:"Se actualizo la contraseña"})}):s.jsx(s.Fragment,{})]})})}),s.jsx(E,{children:s.jsx("div",{className:"pt-5 pb-3",children:s.jsxs("form",{onSubmit:I,children:[m?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"md:flex w-full justify-center mb-7",children:[s.jsxs("div",{className:"md:mx-10 w-full",children:[s.jsx(a,{value:"Antigua contraseña"}),s.jsx(o,{className:"w-full",type:"password",value:N.current_password,onChange:e=>_("current_password",e.target.value)}),s.jsx(n,{message:y.current_password,className:"mt-2"})]}),s.jsxs("div",{className:"md:mx-10 w-full",children:[s.jsx(a,{value:"Nueva contraseña"}),s.jsx(o,{className:"w-full",type:"password",value:N.nueva_pwd,onChange:e=>_("nueva_pwd",e.target.value)}),s.jsx(n,{message:y.nueva_pwd,className:"mt-2"})]})]}),s.jsxs("div",{className:"flex w-full gap-1",children:[s.jsx(C,{content:"Borrarás los cambios",color:"warning",children:s.jsx(t,{variant:"ghost",color:"warning",className:"w-full md:mx-8",onClick:e=>{h(!m)},children:"Cancelar"})}),s.jsx(t,{variant:"ghost",color:"success",className:"w-full md:mx-8",type:"submit",children:"Guardar cambios"})]})]}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex w-full px-8",children:s.jsx(C,{content:"Presiona para ingresar la contraseña actual y luego la nueva",color:"primary",children:s.jsx(t,{variant:"ghost",onClick:()=>h(!m),color:"primary",className:"w-full px-8",children:"Cambiar contraseña"})})})}),w.success_form_pwd?s.jsx(s.Fragment,{children:s.jsx("div",{children:"Se actualizo la contraseña"})}):s.jsx(s.Fragment,{})]})})})]})};export{ls as default};
