import{r as x,q as k,W as _,j as s}from"./app-eXGWw0Q1.js";import{A as M,b as t,t as P,u as G}from"./AuthenticatedLayout-xmXHQCqJ.js";import{T as q}from"./TitleTemplate-g8fmxVri.js";import{C}from"./ContentTemplate-Tjr8Dmcy.js";import{I as a}from"./InputLabel-_BYtn3Q_.js";import{I as c}from"./InputError-Gq9t3JFB.js";import{T as o}from"./TextInput-ahoRra4W.js";import{T as z}from"./toast.esm-hh8KxqiJ.js";import{d as B,a as L,b as V,m as W}from"./chunk-L6QJ42W6-38BLIl0j.js";import"./import-cu65eCSh.js";import"./import-Yb5YGcqg.js";const ls=({auth:r})=>{const p=x.useRef(null),j={success:"success",error:"error"},f={success:"Exito",error:"Error"},h=(e,l,R)=>{p.current.show({severity:l,summary:R,detail:e,life:3e3})},[i,d]=x.useState(!0),[m,u]=x.useState(!1),{hasRole:E,hasPermission:H}=G(),{flash:D}=k().props,{data:n,setData:w,post:F,processing:J,errors:v,reset:g}=_({nombres:r.user.nombres,apellidos:r.user.apellidos,correo:r.user.correo,rut:r.user.rut,rol:r.user.roles,permisos:r.user.permisos}),{data:b,setData:N,post:S,processing:T,errors:y,reset:K}=_({current_password:"",nueva_pwd:""}),A=e=>{e.preventDefault(),F(route("usuario.edit_data"),{onSuccess:()=>d(!i),onError:()=>g("nombres","apellidos")})},I=e=>{e.preventDefault(),S(route("usuario.update_pwd"),{onSuccess:l=>{h(l.update,j.success,f.success),u(!1)},onError:l=>{h(l.update,j.error,f.error)}})};return s.jsxs(M,{user:r.user,header:s.jsx("h2",{className:"font-semibold text-xl text-gray-800 leading-tight",children:"Mi Perfil"}),children:[s.jsx(q,{children:"Mi Perfil"}),s.jsx(z,{ref:p}),s.jsx(C,{children:s.jsx("div",{children:s.jsxs("form",{onSubmit:A,children:[s.jsxs("div",{className:"pt-5",children:[s.jsxs("div",{className:"w-full xl:flex justify-between mb-4",children:[s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Nombres"}),s.jsx(o,{className:"w-full",disabled:i,type:"text",value:n.nombres,onChange:e=>w("nombres",e.target.value)}),s.jsx(c,{message:v.nombres,className:"mt-2"})]}),s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Apellidos"}),s.jsx(o,{className:"w-full",disabled:i,type:"text",value:n.apellidos,onChange:e=>w("apellidos",e.target.value)}),s.jsx(c,{message:v.apellidos,className:"mt-2"})]}),s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Correo"}),s.jsx(o,{className:"w-full",disabled:!0,type:"text",value:n.correo})]})]}),s.jsxs("div",{className:"w-full justify-between xl:flex",children:[s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Rut"}),s.jsx(o,{className:"w-full",disabled:!0,type:"text",value:n.rut})]}),s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Rol"}),s.jsx(o,{className:"w-full",disabled:!0,type:"text",value:n.rol})]}),E("Administrador")?s.jsx(s.Fragment,{children:s.jsxs("div",{className:"w-full mb-2 lg:mx-8",children:[s.jsx(a,{value:"Permisos"}),s.jsxs(B,{type:"listbox",children:[s.jsx(L,{children:s.jsx(t,{variant:"bordered",children:"Ver Permisos"})}),s.jsx(V,{className:"h-64 overflow-auto","aria-label":"Static Actions",children:n.permisos.map((e,l)=>s.jsx(W,{children:e},l))})]})]})}):s.jsx(s.Fragment,{})]})]}),s.jsx("div",{className:"pt-5 xl:flex w-full xl:mx-auto justify-center mt-3 text-large",children:i?s.jsx(s.Fragment,{children:s.jsx(t,{variant:"ghost",color:"primary",className:"w-full xl:mx-8",onClick:e=>d(!i),children:"Editar mis datos"})}):s.jsxs(s.Fragment,{children:[s.jsx(t,{variant:"ghost",color:"warning",className:"w-full xl:mx-8",onClick:e=>{g("nombres","apellidos"),d(!i)},children:"Cancelar"}),s.jsx(t,{variant:"ghost",color:"success",disabled:T,className:"w-full xl:mx-8",type:"submit",children:"Guardar cambios"})]})}),D.success_form_edit?s.jsx(s.Fragment,{children:s.jsx("div",{children:"Se actualizo la contraseña"})}):s.jsx(s.Fragment,{})]})})}),s.jsx(C,{children:s.jsx("div",{className:"pt-5 pb-3",children:s.jsx("form",{onSubmit:I,children:m?s.jsxs(s.Fragment,{children:[s.jsxs("div",{className:"md:flex w-full justify-center mb-7",children:[s.jsxs("div",{className:"md:mx-10 w-full",children:[s.jsx(a,{value:"Antigua contraseña"}),s.jsx(o,{className:"w-full",type:"password",value:b.current_password,onChange:e=>N("current_password",e.target.value)}),s.jsx(c,{message:y.current_password,className:"mt-2"})]}),s.jsxs("div",{className:"md:mx-10 w-full",children:[s.jsx(a,{value:"Nueva contraseña"}),s.jsx(o,{className:"w-full",type:"password",value:b.nueva_pwd,onChange:e=>N("nueva_pwd",e.target.value)}),s.jsx(c,{message:y.nueva_pwd,className:"mt-2"})]})]}),s.jsxs("div",{className:"flex w-full gap-1",children:[s.jsx(P,{content:"Borrarás los cambios",color:"warning",children:s.jsx(t,{variant:"ghost",color:"warning",className:"w-full md:mx-8",onClick:e=>{u(!m)},children:"Cancelar"})}),s.jsx(t,{variant:"ghost",color:"success",className:"w-full md:mx-8",type:"submit",children:"Guardar cambios"})]})]}):s.jsx(s.Fragment,{children:s.jsx("div",{className:"flex w-full px-8",children:s.jsx(P,{content:"Presiona para ingresar la contraseña actual y luego la nueva",color:"primary",children:s.jsx(t,{variant:"ghost",onClick:()=>u(!m),color:"primary",className:"w-full px-8",children:"Cambiar contraseña"})})})})})})})]})};export{ls as default};
